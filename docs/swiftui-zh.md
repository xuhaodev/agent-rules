# SwiftUI

为您的应用在每个平台上声明用户界面和行为。

## 概述

SwiftUI 提供视图、控件和布局结构，用于声明您的应用程序用户界面。该框架提供事件处理程序，用于将点击、手势和其他类型的输入传递给您的应用程序，以及管理数据从应用程序模型流向用户看到并与之交互的视图和控件的工具。

使用 `App` 协议定义您的应用程序结构，并使用包含构成应用程序用户界面的视图的场景来填充它。创建符合 `View` 协议的自定义视图，并将它们与 SwiftUI 视图组合，使用堆栈、列表等显示文本、图像和自定义形状。对内置视图和您自己的视图应用强大的修饰符，以自定义其渲染和交互性。使用适应其上下文和展示的视图和控件在多个平台上的应用程序之间共享代码。

您可以将 SwiftUI 视图与来自 UIKit、AppKit 和 WatchKit 框架的对象集成，以进一步利用平台特定的功能。您还可以在 SwiftUI 中自定义辅助功能支持，并为不同的语言、国家或文化区域本地化您的应用程序界面。

### 特色示例

Landmarks: 使用 Liquid Glass 构建应用

通过系统提供的和自定义的 Liquid Glass 增强您的应用体验。

Destination Video

利用 SwiftUI 在多平台应用中构建沉浸式媒体体验。

BOT-anist

构建使用窗口、体积和动画创建机器人植物学家温室的多平台应用。

使用 SwiftUI 构建基于文档的应用

在多平台应用中创建、保存和打开文档。

## 主题

### 要点

采用 Liquid Glass

了解如何将新材料引入您的应用。

学习 SwiftUI

通过这套概念文章和示例代码发现构建多平台应用的技巧和技术。

探索 SwiftUI 示例应用

在 iPad 上使用 Swift Playgrounds 或在 Xcode 中探索这些 SwiftUI 示例，学习定义用户界面、响应用户交互和管理数据流。

SwiftUI 更新

了解 SwiftUI 的重要变化。

Landmarks: 使用 Liquid Glass 构建应用

通过系统提供的和自定义的 Liquid Glass 增强您的应用体验。

### 应用结构

定义应用的入口点和顶级结构。

声明构成应用各部分的用户界面分组。

在窗口或窗口集合中显示用户界面内容。

在人的周围环境中显示无界内容。

使人们能够打开和管理文档。

使人们能够在场景内的应用视图层次结构的不同部分之间移动。

在提供专注交互的单独视图中展示内容。

提供对常用命令和控件的即时访问。

使人们能够在您的应用中搜索文本或其他内容。

将您的应用的基本功能扩展到系统的其他部分，例如通过添加小组件。

### 数据和存储

管理您的应用用于驱动其界面的数据。

使用环境在视图层次结构中共享数据。

指示从视图到其容器视图的配置首选项。

存储数据以供应用会话之间使用。

### 视图

使用视图层次结构定义应用的可视元素。

调整层次结构中视图的特性。

对不同类型的视图应用内置和自定义外观和行为。

创建平滑的视觉更新以响应状态变化。

显示格式化文本并从用户获取文本输入。

向应用的用户界面添加图像和符号。

显示值并获取用户选择。

提供空间高效、上下文相关的命令和控件访问。

使用颜色、渐变或其他图案描绘和填充内置和自定义形状。

使用图形效果和自定义绘图增强您的视图。

### 视图布局

在内置布局容器（如堆栈和网格）内排列视图。

对对齐、间距、填充和其他布局参数进行精细调整。

在自定义排列中放置视图并创建布局类型之间的动画过渡。

显示结构化、可滚动的信息列。

显示排列在行和列中的可选择、可排序数据。

在不同类型的目的驱动容器中展示视图，如表单或控件组。

使人们能够滚动到当前显示器中不适合的内容。

### 事件处理

定义从点击、单击和滑动到精细手势的交互。

响应来自硬件设备的输入，如键盘或 Touch Bar。

通过发出复制和粘贴命令使人们能够移动或复制项目。

通过将项目从一个位置拖动到另一个位置使人们能够移动或复制项目。

识别和控制哪个可见对象响应用户交互。

对系统事件做出反应，如打开 URL。

### 辅助功能

使您的 SwiftUI 应用对每个人都可访问，包括残疾人。

增强应用界面中内容的易读性。

改善对您的应用可以执行的操作的访问。

描述界面元素以帮助人们了解它们代表什么。

使用户能够使用转子导航到特定的用户界面元素。

### 框架集成

将 AppKit 视图添加到您的 SwiftUI 应用，或在您的 AppKit 应用中使用 SwiftUI 视图。

将 UIKit 视图添加到您的 SwiftUI 应用，或在您的 UIKit 应用中使用 SwiftUI 视图。

将 WatchKit 视图添加到您的 SwiftUI 应用，或在您的 WatchKit 应用中使用 SwiftUI 视图。

使用其他 Apple 框架提供的 SwiftUI 视图。

### 工具支持

生成自定义视图的动态、交互式预览。

在 Xcode 库中公开自定义视图和修饰符。

测量和改善您的应用的响应性。

---

# App 协议

表示应用程序结构和行为的类型。

## 概述

通过声明符合 `App` 协议的结构来创建应用。实现所需的 `body` 计算属性来定义应用的内容：

```swift
@main
struct MyApp: App {
    var body: some Scene {
        WindowGroup {
            Text("Hello, world!")
        }
    }
}
```

在结构声明前加上 @main 属性，以指示您的自定义 `App` 协议符合类型提供了应用的入口点。该协议提供了系统调用以启动应用的 `main()` 方法的默认实现。在应用的所有文件中，您只能有一个入口点。

从符合 `Scene` 协议的实例组成应用的 body。每个场景包含视图层次结构的根视图，并且具有由系统管理的生命周期。SwiftUI 提供一些具体的场景类型来处理常见场景，例如显示文档或设置。您也可以创建自定义场景。

```swift
@main
struct Mail: App {
    var body: some Scene {
        WindowGroup {
            MailViewer()
        }
        Settings {
            SettingsView()
        }
    }
}
```

您可以在应用中声明状态以在其所有场景中共享。例如，您可以使用 `StateObject` 属性来初始化数据模型，然后将该模型作为 `ObservedObject` 在视图输入上提供，或通过环境作为 `EnvironmentObject` 提供给应用中的场景：

```swift
@main
struct Mail: App {
    @StateObject private var model = MailModel()

    var body: some Scene {
        WindowGroup {
            MailViewer()
                .environmentObject(model) // 通过环境传递
        }
        Settings {
            SettingsView(model: model) // 作为观察对象传递
        }
    }
}
```

符合此协议的类型如果在类型的基声明中包含符合性，则从协议继承 `@preconcurrency @MainActor` 隔离：

```swift
struct MyCustomType: Transition {
    // 默认情况下的 `@preconcurrency @MainActor` 隔离
}
```

隔离到主 actor 是默认的，但不是必需的。在扩展中声明符合性以选择退出主 actor 隔离：

```swift
extension MyCustomType: Transition {
    // 默认情况下的 `nonisolated`
}
```

## 主题

### 实现应用

`var body: Self.Body`

应用的内容和行为。

**必需**

`associatedtype Body : Scene`

表示应用内容的场景类型。

### 运行应用

`init()`

使用您为其内容定义的 body 创建应用的实例。

`static func main()`

初始化并运行应用。

---

# View 协议

表示应用用户界面的一部分并提供用于配置视图的修饰符的类型。

## 概述

通过声明符合 `View` 协议的类型来创建自定义视图。实现所需的 `body` 计算属性为您的自定义视图提供内容。

```swift
struct MyView: View {
    var body: some View {
        Text("Hello, World!")
    }
}
```

通过组合 SwiftUI 提供的一个或多个内置视图（如上面示例中的 `Text` 实例）以及您定义的其他自定义视图，将视图的 body 组装成视图层次结构。有关创建自定义视图的更多信息，请参阅声明自定义视图。

`View` 协议提供一组修饰符——具有默认实现的协议方法——您使用它们在应用布局中配置视图。修饰符通过将调用它们的视图实例包装在具有指定特性的另一个视图中来工作，如配置视图中所述。例如，将 `opacity(_:)` 修饰符添加到文本视图会返回具有一定透明度的新视图：

```swift
Text("Hello, World!")
    .opacity(0.5) // 显示部分透明的文本
```

默认修饰符的完整列表提供了大量的视图管理控件。例如，您可以微调布局修饰符、添加辅助功能修饰符信息并响应输入和事件修饰符。您还可以将默认修饰符组收集到新的自定义视图修饰符中以便于重用。

如果符合性在其原始声明中声明，则符合此协议的类型从协议继承 `@preconcurrency @MainActor` 隔离。隔离到主 actor 是默认的，但不是必需的。在扩展中声明符合性以选择退出隔离。

## 主题

### 实现自定义视图

`var body: Self.Body`

视图的内容和行为。

**必需** 提供默认实现。

`associatedtype Body : View`

表示此视图主体的视图类型。

**必需**

将修饰符应用于视图并返回新视图。

生成自定义视图的动态、交互式预览。

### 配置视图元素

使您的 SwiftUI 应用对每个人都可访问，包括残疾人。

配置视图的前景和背景样式、控件和可见性。

管理视图中文本的渲染、选择和输入。

添加和配置支持视图，如工具栏和上下文菜单。

配置您使用 Swift Charts 声明的图表。

### 绘制视图

对不同类型的视图应用内置样式。

通过调整视图的大小、位置、对齐、填充等来告诉视图如何在视图层次结构中排列自己。

影响系统绘制视图的方式，例如通过缩放或遮罩视图，或应用图形效果。

### 提供交互性

为视图提供响应用户输入和系统事件而执行的操作。

使人们能够在您的应用中搜索内容。

定义视图在指定条件下呈现的其他视图。

访问存储并为子视图提供配置数据。

---

# Landmarks: 使用 Liquid Glass 构建应用

通过系统提供的和自定义的 Liquid Glass 增强您的应用体验。

## 概述

Landmarks 是一个 SwiftUI 应用，演示了如何使用新的动态和表现性设计功能 Liquid Glass。Landmarks 应用让人们探索世界各地的有趣景点。无论是家附近的国家公园还是不同大陆上的遥远地点，该应用都为人们提供了组织和标记他们冒险经历的方式，并在此过程中获得自定义活动徽章。Landmarks 在 iPad、iPhone 和 Mac 上运行。

Landmarks 使用 `NavigationSplitView` 来组织和导航应用中的内容，并演示了优化 Liquid Glass 使用的几个关键概念：

- 使用背景扩展效果将内容延伸到侧边栏和检查器后面。

- 将水平滚动视图延伸到侧边栏或检查器下方。

- 在工具栏中利用系统提供的玻璃效果。

- 将 Liquid Glass 效果应用于自定义界面元素和动画。

- 使用 Icon Composer 构建新的应用图标。

该示例还演示了几种在更改窗口大小时使用的技术，以及添加全局搜索的技术。

## 应用背景扩展效果

该示例对顶部视图中的特色地标标题和地标详细视图中的主图像应用背景扩展效果。当侧边栏和检查器打开时，此效果会延伸并模糊侧边栏和检查器下的图像，创造完整的边到边体验。

为了实现此效果，该示例创建并配置一个延伸到包含视图的前导和尾随边缘的 `Image`，并将 `backgroundExtensionEffect()` 修饰符应用于图像。对于特色图像，该示例在修饰符之后添加带有标题和按钮的叠加层，以便只有图像延伸到侧边栏和检查器下方。

有关更多信息，请参阅 Landmarks: 应用背景扩展效果。

## 将水平滚动延伸到侧边栏下方

在 `LandmarksView` 中的每个大陆部分内，`LandmarkHorizontalListView` 的实例显示地标视图的水平滚动列表。打开时，地标视图可以滚动到侧边栏或检查器下方。

为了实现此效果，应用将滚动视图与包含视图的前导和尾随边缘对齐。

有关更多信息，请参阅 Landmarks: 将水平滚动延伸到侧边栏或检查器下方。

## 优化工具栏中的 Liquid Glass

在 `LandmarkDetailView` 中，该示例为以下内容添加了工具栏项目：

- 分享地标

- 在收藏夹列表中添加或删除地标

- 在收藏集中添加或删除地标

- 显示或隐藏检查器

系统自动将 Liquid Glass 应用于工具栏项目。

该示例还将工具栏组织为相关组，而不是将所有按钮放在一个组中。有关更多信息，请参阅 Landmarks: 优化工具栏中系统提供的 Liquid Glass 效果。

## 使用 Liquid Glass 显示徽章

徽章为人们提供了他们在 Landmarks 应用中记录的活动的视觉指示器。当一个人完成地标的所有四个活动时，他们将获得该地标的徽章。该示例使用带有徽章的自定义 Liquid Glass 元素，并展示如何协调 Liquid Glass 的动画。

为了创建自定义 Liquid Glass 徽章，Landmarks 使用带有 `Image` 的视图来显示徽章的系统符号图像。徽章有一个用自定义颜色填充的背景六边形 `Image`。徽章视图使用 `glassEffect(_:in:isEnabled:)` 修饰符将 Liquid Glass 应用于徽章。

为了演示系统通过 Liquid Glass 动画提供的变形效果，该示例将徽章和切换按钮组织到 `GlassEffectContainer` 中，并为每个徽章分配唯一的 `glassEffectID(_:in:)`。

有关更多信息，请参阅 Landmarks: 显示自定义活动徽章。有关使用 Liquid Glass 构建自定义视图的信息，请参阅将 Liquid Glass 应用于自定义视图。

## 使用 Icon Composer 创建应用图标

Landmarks 包括在 Icon Composer 中合成的动态和表现性应用图标。您可以使用四个图层构建应用图标，系统使用这些图层在人们移动设备时产生镜面高光，使图标响应就像光线从玻璃上反射一样。设置应用还允许人们通过选择应用图标的浅色、深色、透明或着色变体来个性化图标。

有关创建新应用图标的更多信息，请参阅使用 Icon Composer 创建应用图标。

---

# 应用组织

定义应用的入口点和顶级结构。

## 概述

以声明式方式描述应用的结构，就像您声明视图的外观一样。创建符合 `App` 协议的类型，并使用它来枚举表示应用用户界面各个方面的场景。

SwiftUI 使您能够编写跨所有 Apple 平台工作的代码。但是，它也使您能够将应用定制为每个平台的特定功能。例如，如果您需要响应系统传统上在 UIKit、AppKit 或 WatchKit 应用委托上进行的回调，请定义一个委托对象并使用适当的委托适配器属性包装器（如 `UIApplicationDelegateAdaptor`）在应用结构中实例化它。

有关平台特定的设计指导，请参阅人机界面指南中的入门。

---

# 场景

声明构成应用各部分的用户界面分组。

## 概述

场景表示应用用户界面的一部分，具有系统管理的生命周期。`App` 实例呈现其包含的场景，而每个 `Scene` 充当 `View` 层次结构的根元素。

系统根据场景类型、平台和上下文以不同方式呈现场景。场景可能填充整个显示器、显示器的一部分、窗口、窗口中的标签页或其他内容。在某些情况下，您的应用还可能能够同时显示场景的多个实例，例如当用户同时打开基于应用中单个 `WindowGroup` 声明的多个窗口时。有关主要内置场景类型的更多信息，请参阅窗口和文档。

您使用修饰符配置场景，类似于配置视图的方式。例如，您可以使用 `windowStyle(_:)` 修饰符调整包含场景的窗口的外观——如果场景恰好出现在窗口中。类似地，您可以使用 `commands(content:)` 修饰符添加在特定平台上场景处于前台时可用的菜单命令。

---

# 窗口

在窗口或窗口集合中显示用户界面内容。

## 概述

在应用界面中呈现视图层次结构的最常见方式是使用 `WindowGroup`，它产生平台特定的行为和外观。

在支持它的平台上，人们可以同时从组中打开多个窗口。每个窗口依赖于相同的根视图定义，但保留自己的视图状态。在某些平台上，您还可以使用 `Window` 场景类型补充应用的用户界面与单实例窗口。

使用您添加到窗口声明的场景修饰符配置窗口，如 `windowStyle(_:)` 或 `defaultPosition(_:)`。您还可以通过向层次结构中的视图添加 `presentedWindowStyle(_:)` 视图修饰符来指示如何配置从视图层次结构呈现的新窗口。

有关设计指导，请参阅人机界面指南中的窗口。

---

# 沉浸式空间

在人的周围环境中显示无界内容。

## 概述

在 visionOS 中使用沉浸式空间在任何容器之外呈现 SwiftUI 视图。您可以在空间中包含任何视图，尽管您通常使用 `RealityView` 来呈现 RealityKit 内容。

您可以使用 `immersionStyle(selection:in:)` 场景修饰符请求三种空间样式之一：

- `mixed` 样式将您的内容与透视混合。这使您能够在人的周围环境中放置虚拟对象。

- `full` 样式仅显示您的内容，关闭透视。这使您能够完全控制视觉体验，例如当您想要将人们传送到新世界时。

- `progressive` 样式在显示器的一部分中完全替换透视。您可能使用此样式让人们扎根于现实世界，同时显示通往另一个世界的视图。

当您打开沉浸式空间时，系统继续显示应用的所有窗口，但隐藏其他应用的窗口。系统支持在所有应用中一次仅显示一个空间，因此您的应用只有在没有空间已经打开的情况下才能打开空间。
